<div class="dialog-container">
  <h2 mat-dialog-title>
    DÃ©tails du Document
  </h2>

  <mat-dialog-content>
    <div class="document-info">
      <p><strong>Title:</strong> <span>{{ document.title }}</span></p>
      <p><strong>Author:</strong> <span>{{ document.author }}</span></p>
      <p><strong>Description:</strong> <span>{{ document.description || 'No description provided' }}</span></p>
      <p><strong>Creation date:</strong> <span>{{ document.createdAt | date:'dd/MM/yyyy HH:mm' }}</span></p>
    </div>

    <div class="feedback-section">
      <h3 class="section-title">Add a comment</h3>

      <mat-form-field appearance="fill" class="textarea-field w-100">
        <mat-label>Comment</mat-label>
        <textarea matInput [(ngModel)]="feedbackContent" rows="3"></textarea>
      </mat-form-field>

      <h4>Evaluation</h4>
      <div class="rating-stars">
        <mat-icon
          *ngFor="let star of stars; let i = index"
          (click)="setRating(i + 1)"
          [ngClass]="{
            'text-warning': i < feedbackRating,
            'cursor-pointer': true
          }">
          {{ i < feedbackRating ? 'star' : 'star_border' }}
        </mat-icon>
      </div>

      <button
        mat-raised-button
        class="submit-button"
        (click)="submitFeedback()"
        [disabled]="isSubmitting || !isFeedbackValid()">
        {{ isSubmitting ? 'Sending in progress...' : 'Send' }}
      </button>
    </div>

    <div class="feedbacks-section">
      <h3 class="section-title">Feedbacks</h3>

      <div *ngIf="feedbacks.length === 0" class="no-feedbacks">
        No comments yet.
      </div>

      <div *ngFor="let fb of feedbacks" class="feedback-item">
        <div class="feedback-content">
          {{ fb.content }}
        </div>
        <div class="feedback-rating">
          <mat-icon *ngFor="let star of stars; let i = index" [class.text-warning]="i < fb.note">
            {{ i < fb.note ? 'star' : 'star_border' }}
          </mat-icon>
        </div>
        <div class="feedback-date">
          {{ convertToDate(fb.createdAt) | date:'short' }}
        </div>
      </div>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button class="close-button" (click)="closeDialog()">Close</button>
  </mat-dialog-actions>
</div>
