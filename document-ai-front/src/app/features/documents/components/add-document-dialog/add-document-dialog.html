<h2 class="text-2xl text-center font-semibold mb-4 text-gray-800 px-4">Ajouter un document</h2>

<mat-dialog-content class="p-4 space-y-4" style="overflow: visible; max-height: none;">
  <form [formGroup]="documentForm" (ngSubmit)="onSubmit()" class="space-y-4 w-full">

    <mat-form-field appearance="fill" class="w-full">
      <mat-label>Title</mat-label>
      <input matInput formControlName="title" class="text-sm" />
    </mat-form-field>

    <mat-form-field appearance="fill" class="w-full">
      <mat-label>Author</mat-label>
      <input matInput formControlName="author" class="text-sm" />
    </mat-form-field>

    <div class="border-2 border-dashed border-gray-300 rounded-md p-4 text-center bg-gray-50">
      <input type="file" hidden (change)="onFileSelected($event)" #fileInput />
      <button mat-stroked-button type="button"
              class="!border-blue-500 !text-blue-600 hover:!bg-blue-50"
              (click)="fileInput.click()">
        Upload file
      </button>
            <div *ngIf="selectedFileName" class="mt-2 text-sm text-gray-600">
        Fichier sélectionné : {{ selectedFileName }}
      </div>
      <div *ngIf="documentForm.get('file')?.touched && documentForm.get('file')?.invalid"
            class="text-red-500 text-sm mt-1">
          File is required.
        </div>
      </div>

    <mat-form-field appearance="fill" class="w-full">
      <mat-label>Description</mat-label>
      <textarea matInput formControlName="description" rows="4" class="text-sm"></textarea>
    </mat-form-field>

    <div class="flex justify-end gap-3 pt-4">
      <button mat-button type="button"
              class="!text-gray-700 !bg-gray-100 hover:!bg-gray-200"
              (click)="onCancel()">
        Cancel
      </button>
      <button mat-stroked-button type="button"
              color="accent"
              (click)="generateDescription()"
              [disabled]="isGenerating || !documentForm.value.file">
        @if (!isGenerating) {
          <mat-icon>auto_awesome</mat-icon>
        }
        @if (isGenerating) {
          <mat-icon class="spinning-icon">refresh</mat-icon>
        }
        <span style="margin-left: 8px;">
    {{ isGenerating ? 'Generating...' : 'Generate' }}
  </span>
      </button>


      <button mat-raised-button color="primary" type="submit"
              class="!bg-blue-600 !text-white hover:!bg-blue-700">
        Add
      </button>
    </div>
  </form>
</mat-dialog-content>
